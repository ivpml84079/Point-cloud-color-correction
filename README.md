# Point-cloud-color-correction

"A Novel Grouping-Based Hybrid Color Correction Algorithm for Color Point Clouds" (2024) by Kuo-Liang Chung and Ting-Chung Tang.

<div align=center>
<img src="https://github.com/ivpml84079/Point-cloud-color-correction/blob/main/Fig/Example.png">
</div>

The visual effects of our color correction algorithm for the six color point cloud pairs, which can be accessed from the dataset [SHOT](http://vision.deis.unibo.it/research/80-shot), are illustrated 
in the above figures where for each figure pair, the left figure denotes the original alignment without color correction and the right figure denotes the color-corrected alignment.

## Environment & Library
* Windows 10, Visual Studio 2022 (v143), Windows SDK 10.0, ISO C++17

* [Point Cloud Library](https://pointclouds.org/) 1.13.0

* [OpenCV](https://opencv.org/) 4.6.0

## Data preprocess
1. After downloading the **dataset 5** from SHOT dataset, using the program in [CloudCompare](https://www.danielgm.net/cc/) to convert the file
   from Mesh vertices to point cloud, place them in their respective folders.

2. Apply a point cloud registration method to obtain the estimated transformation matrix which is used to map the source point cloud to an aligned source point cloud.
   Save the obtained transformation matrix as a ```.txt``` file and put it in the appropriate directory.

* Please refer to the file lacation and naming rules in the '/Data/Mario' folder for guidance.

## User define parameters
```overlap_dist``` is a distance threshold used to determine whether the aligned source point and its nearest target point are within the overlapping area. 

```overlap_th``` is the overlapping rate threshold used to determine applying the bi-group partition or the tri-group partition.

```close_color_constrain``` is the CIELAB color constrain used in <img src="https://latex.codecogs.com/gif.latex?G^{close}"/>.

```moderate_color_constrain``` is the CIELAB color constrain used in <img src="https://latex.codecogs.com/gif.latex?G^{moderate}"/>.

## Performance comparison
Since point clouds consist of points in 3D space, evaluating the effectiveness of color correction requires loading a point cloud pair to confirm its visual effects. 
Based on the selected six point cloud pairs, the color-correction effects of all considered methods are illustrated in the '/Fig' floder.

To view the visual effects for all 146 testing point cloud pairs, please follow the instructions below:

* You can inspect the pre-color-corrected state by loading both the ```aligned_source.ply``` and ```dark_target.ply``` generated by
  the program.

* To view the color-corrected result of our algorithm, load ```aligned_source.ply``` along with either ```triClass_color_correction.ply```
  or ```biClass_color_correction.ply``` .

* The results of the five comparative methods, the NN-based method, the KNN-based method, the HM-based method, and the HHM-based method, can be examined by
  loading ```aligned_source.ply``` along with the individual file ```nn_color_correction.ply```, ```knn_color_correction.ply```,
  ```Fecker_color_correction.ply```, and ```Ding_color_correction.ply```, respectively. The AGL-based method can be examined by loading
  ```Yu_source.ply``` and ```Yu_target.ply``` .
  
* The above concerned operations can be performed using the above-mentioned software: CloudCompare.

All color-corrected results for all 146 testing point cloud pairs can be accessed from [result](https://drive.google.com/drive/folders/1Fsl_6wpDb8jv56x0_hjYOaHO0HWVDRnY?usp=sharing).

## Contact
If you have any questions, please email us via   
Ting-Chung Tang: m11115097@mail.ntust.edu.tw  
Kuo-Liang Chung: klchung01@gmail.com
